# 网站内容管理系统（CMS）改造方案

## 1. 背景与问题
目前网站（知命达理容易斋）是一个纯静态的 HTML/CSS/JS 项目。所有文章内容（如《学易的第一性》等）都直接硬编码在 `.html` 文件中，且首页的文章列表也是手动维护的。

**存在的问题：**
*   **维护成本高**：每次新增文章，开发人员需要复制 HTML 文件，修改内部文字，还要手动更新首页的列表链接。
*   **非技术人员无法操作**：内容创作者（需求方）不懂 HTML 代码，无法自行发布或修改错别字。
*   **容易出错**：手动修改 HTML 标签容易导致页面布局崩坏。

## 2. 解决方案：Git-based CMS (Decap CMS) + 静态生成

我们将采用“内容与代码分离”的架构，引入自动化构建流程，并最终接入可视化后台。

### 核心优势
1.  **零成本**：继续使用 GitHub + Cloudflare Pages，无需购买服务器或数据库。
2.  **自动化**：文章写好后，首页列表、文章详情页自动生成，无需人工干预 HTML。
3.  **可视化**：为内容创作者提供类似公众号后台的写作界面。

---

## 3. 实施步骤

我们将改造分为两个阶段，阶段一完成后即可解决“开发人员维护麻烦”的问题，阶段二完成后解决“内容创作者无法操作”的问题。

### 阶段一：架构重构（内容与代码分离）
**目标**：将文章从 HTML 代码中剥离，转为 Markdown 文档。

1.  **创建内容目录**：建立 `content/articles/` 目录，存放 `.md` 文件。
    *   例如：`content/articles/2025-09-23-first-principles.md`
    *   文件头部包含元数据（标题、日期、封面图、简介等）。
2.  **创建 HTML 模板**：提取现有的文章页样式，制作一个统一的 `article-template.html`。
3.  **编写构建脚本**：
    *   开发一个 Node.js 脚本，在构建时自动扫描 `.md` 文件。
    *   将 Markdown 转换为 HTML，套用模板生成最终页面。
    *   自动更新首页（`index.html`）的文章列表区域。
4.  **调整开发流程**：
    *   以后只需在文件夹里丢一个 `.md` 文件，运行 `npm run build`，网站就会自动更新。

### 阶段二：接入 Decap CMS（可视化后台）
**目标**：提供网页版后台，让非技术人员直接在浏览器里写文章。

1.  **添加 Admin 页面**：在网站中增加 `/admin` 路径。
2.  **配置 CMS**：设置 `config.yml`，定义文章有哪些字段（标题、封面图、正文等）。
3.  **权限设置**：
    *   内容创作者注册一个 GitHub 账号。
    *   您在 GitHub 仓库中将其添加为协作者。
    *   配置 Cloudflare Pages 的身份认证网关。

---

## 4. 角色与工作流对比

### 当前工作流（改造前）
1.  **创作者**：把 Word 文档发给开发人员。
2.  **开发人员**：复制 `article.html` -> 粘贴文字 -> 修改 HTML 标签 -> 打开 `index.html` -> 复制列表项 -> 修改链接 -> 提交代码。

### 改造后工作流（阶段二完成后）
1.  **创作者**：
    *   打开 `rongyizhai.de5.net/admin`。
    *   点击“Login with GitHub”。
    *   点击“新建文章”，上传封面图，输入标题和正文（所见即所得）。
    *   点击“Publish（发布）”。
2.  **系统**：
    *   自动将内容推送到 GitHub。
    *   Cloudflare Pages 检测到更新，自动运行构建脚本。
    *   网站自动上线新内容。
3.  **开发人员**：无需介入日常内容更新，专注于样式和功能开发。

## 5. 技术栈变更
*   **新增依赖**：
    *   `front-matter`: 用于解析文章元数据。
    *   `marked`: 用于将 Markdown 转为 HTML。
    *   `decap-cms-app`: CMS 前端核心库。
*   **文件结构变化**：
    ```text
    /content/articles/*.md  <-- 文章源文件（新增）
    /scripts/build.js       <-- 自动化生成脚本（新增）
    /public/admin/          <-- 后台页面（新增）
    /src/templates/         <-- 页面模板（新增）
    ```

## 6. 评估结论
此方案是静态网站领域最成熟、性价比最高的方案。它既保留了静态网站的高性能和安全性，又解决了内容管理的痛点。

**建议立即启动阶段一，将现有 HTML 文章转换为 Markdown，以清理代码库。**
